schema: '2.0'
stages:
  data_load:
    cmd: python src/pipelines/data_load.py --config=params.yaml
    deps:
    - path: src/pipelines/data_load.py
      md5: d0e1b140b7d7bfb2a1e0f590bf20e41f
      size: 660
    params:
      params.yaml:
        base:
          project: mlrepa-week
          model:
            model_name: model.joblib
            models_folder: models
          reports:
            reports_folder: reports
          random_state: 42
        data_load:
          dataset_csv: data/raw/iris.csv
    outs:
    - path: data/raw/iris.csv
      md5: 4224576f0267bf88902f87f0f6200967
      size: 2757
  featurize:
    cmd: python src/pipelines/featurize.py --config=params.yaml
    deps:
    - path: data/raw/iris.csv
      md5: 4224576f0267bf88902f87f0f6200967
      size: 2757
    - path: src/pipelines/featurize.py
      md5: 924b1b6154d4d29cafd402faadae450a
      size: 864
    params:
      params.yaml:
        base:
          project: mlrepa-week
          model:
            model_name: model.joblib
            models_folder: models
          reports:
            reports_folder: reports
          random_state: 42
        data_load:
          dataset_csv: data/raw/iris.csv
        featurize:
          features_path: data/processed/featured_iris.csv
          target_column: target
    outs:
    - path: data/processed/featured_iris.csv
      md5: 5d03a1564b3038fc35a842f8e4bde491
      size: 7260
  data_split:
    cmd: python src/pipelines/data_split.py --config=params.yaml
    deps:
    - path: data/processed/featured_iris.csv
      md5: 5d03a1564b3038fc35a842f8e4bde491
      size: 7260
    - path: src/pipelines/data_split.py
      md5: 13a5b32aaafdd41191d3caacfefaba6f
      size: 1204
    params:
      params.yaml:
        base:
          project: mlrepa-week
          model:
            model_name: model.joblib
            models_folder: models
          reports:
            reports_folder: reports
          random_state: 42
        data_split:
          folder: experiments
          train_path: data/processed/train_iris.csv
          test_path: data/processed/test_iris.csv
          test_size: 0.3
        featurize:
          features_path: data/processed/featured_iris.csv
          target_column: target
    outs:
    - path: data/processed/test_iris.csv
      md5: a4062ba6421285181f76cad57ab08d43
      size: 2140
    - path: data/processed/train_iris.csv
      md5: df48a3b56d578d45d0794798ad2cd31d
      size: 5076
  train:
    cmd: python src/pipelines/train.py --config=params.yaml
    deps:
    - path: data/processed/train_iris.csv
      md5: df48a3b56d578d45d0794798ad2cd31d
      size: 5076
    - path: src/pipelines/train.py
      md5: 49c079a2a9a566b452d089734793e9ba
      size: 1182
    params:
      params.yaml:
        base:
          project: mlrepa-week
          model:
            model_name: model.joblib
            models_folder: models
          reports:
            reports_folder: reports
          random_state: 42
        data_split.train_path: data/processed/train_iris.csv
        featurize.target_column: target
        train:
          cv: 3
          estimator_name: logreg
          estimators:
            logreg_baseline:
              C: 0.001
              max_iter: 100
              solver: lbfgs
              multi_class: multinomial
            logreg:
              param_grid:
                C:
                - 0.001
                max_iter:
                - 100
                solver:
                - lbfgs
                multi_class:
                - multinomial
            svm:
              param_grid:
                C:
                - 0.1
                - 1.0
                kernel:
                - rbf
                - linear
                gamma:
                - scale
                degree:
                - 3
                - 5
    outs:
    - path: models/model.joblib
      md5: 80511142369b372674b3ef873a269c0b
      size: 3358
  evaluate:
    cmd: python src/pipelines/evaluate.py --config=params.yaml
    deps:
    - path: data/processed/test_iris.csv
      md5: a4062ba6421285181f76cad57ab08d43
      size: 2140
    - path: models/model.joblib
      md5: 80511142369b372674b3ef873a269c0b
      size: 3358
    - path: src/pipelines/evaluate.py
      md5: f9137826a8c1177c24ed4718ff4aacb3
      size: 2343
    params:
      params.yaml:
        base:
          project: mlrepa-week
          model:
            model_name: model.joblib
            models_folder: models
          reports:
            reports_folder: reports
          random_state: 42
        data_split.test_path: data/processed/test_iris.csv
        evaluate:
          metrics_file: metrics.json
          confusion_matrix_png: confusion_matrix.png
          classes_path: classess.csv
        featurize.target_column: target
    outs:
    - path: reports/classess.csv
      md5: 0c13fca59b8c1d3142d9a4dea01c2608
      size: 835
    - path: reports/confusion_matrix.png
      md5: a269f8e912d051b1bd93c77c9b270a51
      size: 26265
    - path: reports/metrics.json
      md5: 1e908c0d19c3d004e3dccbb2a630daad
      size: 32
